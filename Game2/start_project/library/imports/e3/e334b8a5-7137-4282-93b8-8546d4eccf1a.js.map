{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Star.js"],"names":["cc","Class","extends","Component","properties","pickRadius","start","getPlayerDistance","player","playerPos","getPosition","dist","node","position","sub","mag","onPicked","index","game","spawnNewStar","gainScore","destroy","getWinner","y","player2","update","dt"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACAC,oBAAY;AAFJ,KAHP;;AAQL;;AAEA;;AAEAC,SAZK,mBAYI,CAER,CAdI;;;AAgBLC,uBAAmB,2BAAUC,MAAV,EAAkB;AACjC;AACA,YAAIC,YAAYD,OAAOE,WAAP,EAAhB;AACA;AACA,YAAIC,OAAO,KAAKC,IAAL,CAAUC,QAAV,CAAmBC,GAAnB,CAAuBL,SAAvB,EAAkCM,GAAlC,EAAX;AACA,eAAOJ,IAAP;AACH,KAtBI;;AAwBLK,cAAU,kBAASC,KAAT,EAAgB;AACtB;AACA,aAAKC,IAAL,CAAUC,YAAV;AACA;AACA,aAAKD,IAAL,CAAUE,SAAV,CAAoBH,KAApB;AACA;AACA,aAAKL,IAAL,CAAUS,OAAV;AACH,KA/BI;;AAiCLC,eAAW,qBAAW;AAClB,YAAIC,IAAI,KAAKL,IAAL,CAAUM,OAAV,CAAkBd,WAAlB,EAAR;AACA,YAAG,KAAKQ,IAAL,CAAUV,MAAV,CAAiBK,QAAjB,CAA0BC,GAA1B,CAA8BS,CAA9B,EAAiCR,GAAjC,KAAuC,KAAKV,UAA/C,EAA0D;AACtD,iBAAKa,IAAL,CAAUI,SAAV;AACH;AAEJ,KAvCI;;AAyCLG,YAAQ,gBAAUC,EAAV,EAAc;AAClB,aAAKJ,SAAL;AACA;AACA;AACA,YAAG,KAAKf,iBAAL,CAAuB,KAAKW,IAAL,CAAUV,MAAjC,IAAyC,KAAKH,UAA9C,IAA4D,KAAKE,iBAAL,CAAuB,KAAKW,IAAL,CAAUM,OAAjC,IAA0C,KAAKnB,UAA9G,EAA0H;AACtH;AACA,iBAAKW,QAAL;AACA;AACH,SAJD,MAIO,IAAI,KAAKT,iBAAL,CAAuB,KAAKW,IAAL,CAAUV,MAAjC,IAA2C,KAAKH,UAApD,EAAgE;AACnE;AACA,iBAAKW,QAAL,CAAc,CAAd;AACA;AACH,SAJM,MAIA,IAAG,KAAKT,iBAAL,CAAuB,KAAKW,IAAL,CAAUM,OAAjC,IAA0C,KAAKnB,UAAlD,EAA8D;AAClE,iBAAKW,QAAL,CAAc,CAAd;AACA;AACF;AAEJ;AACD;AA3DK,CAAT","file":"Star.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 主角和星星小于这个距离的时候就会被收集\r\n        pickRadius: 0,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    getPlayerDistance: function (player) {\r\n        // 根据 player 节点位置判断距离\r\n        var playerPos = player.getPosition();\r\n        // 根据两点位置计算两点之间距离\r\n        var dist = this.node.position.sub(playerPos).mag();\r\n        return dist;\r\n    },\r\n\r\n    onPicked: function(index) {\r\n        // 当星星被收集时，调用 Game 脚本中的接口，生成一个新的星星\r\n        this.game.spawnNewStar();\r\n        // 调用Game得分方法\r\n        this.game.gainScore(index);\r\n        // 然后销毁当前星星节点\r\n        this.node.destroy();\r\n    },\r\n\r\n    getWinner: function() {\r\n        var y = this.game.player2.getPosition();\r\n        if(this.game.player.position.sub(y).mag()<this.pickRadius){\r\n            this.game.getWinner();\r\n        }\r\n\r\n    },\r\n\r\n    update: function (dt) {\r\n        this.getWinner()\r\n        // 每帧判断和主角之间的距离是否小于收集距离\r\n        // 这一块应该处理一下当两个同时吃到星星的情况\r\n        if(this.getPlayerDistance(this.game.player)<this.pickRadius && this.getPlayerDistance(this.game.player2)<this.pickRadius) {\r\n            // 当两个同时触碰到的情况\r\n            this.onPicked();\r\n            return;\r\n        } else if (this.getPlayerDistance(this.game.player) < this.pickRadius) {\r\n            // 调用收集行为\r\n            this.onPicked(1);\r\n            return;\r\n        } else if(this.getPlayerDistance(this.game.player2)<this.pickRadius) {\r\n           this.onPicked(2);\r\n           return; \r\n        }\r\n\r\n    },\r\n    // update (dt) {},\r\n});\r\n"]}